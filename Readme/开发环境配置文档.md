# AI会议助手开发环境配置文档

## 1. 文档概述

### 1.1 文档目的
本文档详细描述AI会议助手的开发环境配置，包括前端、后端、Docker、数据库、环境变量等方面的配置，为开发团队提供明确的环境配置指导，确保开发环境的一致性和稳定性。

### 1.2 术语定义
| 术语 | 解释 |
|------|------|
| Node.js | 后端JavaScript运行环境 |
| npm | Node.js的包管理器 |
| PostgreSQL | 关系型数据库 |
| MongoDB | 文档型数据库 |
| Docker | 容器化平台 |
| Docker Compose | Docker的编排工具 |
| .env | 环境变量配置文件 |

## 2. 系统要求

### 2.1 硬件要求
- CPU：至少4核
- 内存：至少8GB RAM
- 磁盘：至少50GB可用空间

### 2.2 软件要求
- 操作系统：
  - Windows 10/11（建议使用WSL 2）
  - macOS 13.x 或更高版本
  - Linux（Ubuntu 22.04 LTS 或更高版本）
- Node.js：18.18.x 或更高版本
- npm：9.x 或更高版本
- Git：2.30.x 或更高版本
- Docker：24.x 或更高版本（可选，用于容器化开发）
- Docker Compose：2.23.x 或更高版本（可选，用于容器化开发）

## 3. 前端开发环境配置

### 3.1 初始化步骤

1. **克隆代码仓库**
   ```bash
   git clone <repository-url>
   cd <repository-directory>
   ```

2. **进入前端目录**
   ```bash
   cd frontend
   ```

3. **安装依赖**
   ```bash
   npm install
   ```

4. **配置环境变量**
   ```bash
   cp .env.example .env
   ```
   编辑 `.env` 文件，配置以下环境变量：
   ```
   VITE_API_BASE_URL=http://localhost:3000/api/v1
   VITE_WEBSOCKET_URL=ws://localhost:3000
   ```

5. **启动开发服务器**
   ```bash
   npm run dev
   ```

6. **访问前端应用**
   打开浏览器，访问：`http://localhost:5173`

### 3.2 项目结构

```
frontend/
├── public/                 # 静态资源
├── src/
│   ├── assets/            # 资源文件
│   ├── components/        # 通用组件
│   ├── views/             # 页面组件
│   ├── stores/            # Pinia状态管理
│   ├── router/            # Vue Router配置
│   ├── api/               # API请求封装
│   ├── utils/             # 工具函数
│   ├── types/             # TypeScript类型定义
│   ├── App.vue            # 根组件
│   └── main.ts            # 入口文件
├── .env.example           # 环境变量示例
├── .env                   # 环境变量配置
├── tsconfig.json          # TypeScript配置
├── vite.config.ts         # Vite配置
├── package.json           # 项目配置和依赖
└── README.md              # 项目说明
```

### 3.3 脚本命令

| 命令 | 用途 |
|------|------|
| `npm run dev` | 启动开发服务器 |
| `npm run build` | 构建生产版本 |
| `npm run preview` | 预览生产构建 |
| `npm run lint` | 运行ESLint检查 |
| `npm run format` | 运行Prettier格式化代码 |
| `npm run typecheck` | 运行TypeScript类型检查 |

### 3.4 开发工具配置

#### 3.4.1 VS Code插件推荐

| 插件名称 | 用途 |
|----------|------|
| Vue Language Features (Volar) | Vue 3语法支持 |
| TypeScript Vue Plugin (Volar) | Vue 3 TypeScript支持 |
| ESLint | 代码质量检查 |
| Prettier - Code formatter | 代码格式化 |
| GitLens | Git增强功能 |
| Docker | Docker支持 |
| REST Client | API测试 |

#### 3.4.2 VS Code设置推荐

```json
{
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "prettier.requireConfig": true,
  "[vue]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[typescript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[javascript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  }
}
```

## 4. 后端开发环境配置

### 4.1 初始化步骤

1. **克隆代码仓库**（如果尚未克隆）
   ```bash
   git clone <repository-url>
   cd <repository-directory>
   ```

2. **进入后端目录**
   ```bash
   cd backend
   ```

3. **安装依赖**
   ```bash
   npm install
   ```

4. **配置环境变量**
   ```bash
   cp .env.example .env
   ```
   编辑 `.env` 文件，配置以下环境变量：
   ```
   # 服务器配置
   PORT=3000
   HOST=localhost
   NODE_ENV=development

   # 数据库配置
   POSTGRES_HOST=localhost
   POSTGRES_PORT=5432
   POSTGRES_USER=postgres
   POSTGRES_PASSWORD=password
   POSTGRES_DB=ai_meeting_assistant

   MONGO_URI=mongodb://localhost:27017/ai_meeting_assistant

   # JWT配置
   JWT_SECRET=your_jwt_secret
   JWT_EXPIRES_IN=7d

   # Redis配置
   REDIS_HOST=localhost
   REDIS_PORT=6379
   REDIS_PASSWORD=

   # RabbitMQ配置
   RABBITMQ_HOST=localhost
   RABBITMQ_PORT=5672
   RABBITMQ_USER=guest
   RABBITMQ_PASSWORD=guest
   RABBITMQ_VHOST=/

   # 第三方服务配置
   DOUBAO_SPEECH_API_KEY=your_doubao_speech_api_key
   DOUBAO_SPEECH_SECRET_KEY=your_doubao_speech_secret_key
   DOUBAO_SPEECH_APP_ID=your_doubao_speech_app_id

   AI_MODEL_API_KEY=your_ai_model_api_key
   ```

5. **启动开发服务器**
   ```bash
   npm run dev
   ```

6. **访问后端API**
   - API地址：`http://localhost:3000/api/v1`
   - Swagger文档：`http://localhost:3000/api-docs`

### 4.2 项目结构

```
backend/
├── src/
│   ├── app.module.ts      # 应用主模块
│   ├── config/            # 配置管理
│   ├── controllers/       # 控制器
│   ├── modules/           # 功能模块
│   │   ├── session/       # 会话模块
│   │   ├── speech/        # 语音处理模块
│   │   ├── ai/            # AI分析模块
│   │   └── user/          # 用户模块
│   ├── services/          # 业务服务
│   ├── guards/            # 守卫
│   ├── middleware/        # 中间件
│   ├── filters/           # 异常过滤器
│   ├── pipes/             # 管道
│   ├── utils/             # 工具函数
│   ├── types/             # TypeScript类型定义
│   └── main.ts            # 应用入口
├── .env.example           # 环境变量示例
├── .env                   # 环境变量配置
├── tsconfig.json          # TypeScript配置
├── package.json           # 项目配置和依赖
└── README.md              # 项目说明
```

### 4.3 脚本命令

| 命令 | 用途 |
|------|------|
| `npm run dev` | 启动开发服务器 |
| `npm run build` | 构建生产版本 |
| `npm run start` | 启动生产服务器 |
| `npm run lint` | 运行ESLint检查 |
| `npm run format` | 运行Prettier格式化代码 |
| `npm run typecheck` | 运行TypeScript类型检查 |
| `npm run migrate` | 运行数据库迁移 |

### 4.4 开发工具配置

#### 4.4.1 VS Code插件推荐

| 插件名称 | 用途 |
|----------|------|
| ESLint | 代码质量检查 |
| Prettier - Code formatter | 代码格式化 |
| GitLens | Git增强功能 |
| Docker | Docker支持 |
| REST Client | API测试 |
| PostgreSQL | PostgreSQL支持 |
| MongoDB for VS Code | MongoDB支持 |

## 5. 数据库配置

### 5.1 PostgreSQL配置

#### 5.1.1 安装PostgreSQL

##### macOS
```bash
# 使用Homebrew安装
brew install postgresql@15
# 启动服务
brew services start postgresql@15
# 初始化数据库
initdb /usr/local/var/postgres
```

##### Ubuntu
```bash
# 更新包列表
sudo apt update
# 安装PostgreSQL
sudo apt install postgresql-15 postgresql-contrib-15
# 启动服务
sudo systemctl start postgresql
# 设置开机自启
sudo systemctl enable postgresql
```

##### Windows
- 下载安装包：[PostgreSQL 15](https://www.postgresql.org/download/windows/)
- 按照安装向导进行安装
- 记住设置的密码，后续配置需要使用

#### 5.1.2 创建数据库和用户

```bash
# 进入PostgreSQL命令行
sudo -u postgres psql

# 创建用户
CREATE USER postgres WITH PASSWORD 'password';
# 授予超级用户权限
ALTER USER postgres WITH SUPERUSER;
# 创建数据库
CREATE DATABASE ai_meeting_assistant;
# 授予用户访问权限
GRANT ALL PRIVILEGES ON DATABASE ai_meeting_assistant TO postgres;
# 退出命令行
\q
```

#### 5.1.3 验证连接

```bash
# 使用psql连接数据库
psql -h localhost -U postgres -d ai_meeting_assistant
```

### 5.2 MongoDB配置

#### 5.2.1 安装MongoDB

##### macOS
```bash
# 使用Homebrew安装
brew tap mongodb/brew
brew install mongodb-community@6.0
# 启动服务
brew services start mongodb-community@6.0
```

##### Ubuntu
```bash
# 导入MongoDB GPG密钥
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927
# 添加MongoDB源
echo "deb http://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list
# 更新包列表
sudo apt update
# 安装MongoDB
sudo apt install -y mongodb-org
# 启动服务
sudo systemctl start mongod
# 设置开机自启
sudo systemctl enable mongod
```

##### Windows
- 下载安装包：[MongoDB Community Server 6.0](https://www.mongodb.com/try/download/community)
- 按照安装向导进行安装
- 选择"Complete"安装类型
- 勾选"Install MongoDB Compass"（可选，图形化管理工具）

#### 5.2.2 验证连接

```bash
# 使用mongo命令连接
mongosh
# 显示数据库列表
show dbs
# 退出命令行
quit()
```

#### 5.2.3 创建数据库

```bash
# 连接MongoDB
mongosh
# 创建数据库
use ai_meeting_assistant
# 创建用户（可选，用于生产环境）
db.createUser({
  user: "mongouser",
  pwd: "mongopassword",
  roles: [{ role: "dbOwner", db: "ai_meeting_assistant" }]
})
# 退出命令行
quit()
```

## 6. Docker开发环境配置

### 6.1 安装Docker和Docker Compose

#### macOS
- 下载并安装Docker Desktop：[Docker Desktop for Mac](https://www.docker.com/products/docker-desktop/)
- Docker Desktop包含Docker Compose

#### Ubuntu
```bash
# 安装Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
# 安装Docker Compose
sudo apt install docker-compose-plugin
# 将当前用户添加到docker组
sudo usermod -aG docker $USER
# 刷新组权限
newgrp docker
```

#### Windows
- 下载并安装Docker Desktop：[Docker Desktop for Windows](https://www.docker.com/products/docker-desktop/)
- 确保启用WSL 2

### 6.2 使用Docker Compose启动服务

1. **进入项目根目录**
   ```bash
   cd <repository-directory>
   ```

2. **配置环境变量**
   ```bash
   cp .env.example .env
   ```
   编辑 `.env` 文件，配置所需的环境变量

3. **启动Docker容器**
   ```bash
   docker-compose up -d
   ```

4. **查看容器状态**
   ```bash
   docker-compose ps
   ```

5. **访问服务**
   - 前端：`http://localhost:5173`
   - 后端API：`http://localhost:3000/api/v1`
   - Swagger文档：`http://localhost:3000/api-docs`
   - PostgreSQL：`localhost:5432`
   - MongoDB：`localhost:27017`

### 6.3 Docker Compose配置

```yaml
version: '3.8'
services:
  frontend:
    build: ./frontend
    ports:
      - "5173:5173"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    environment:
      - VITE_API_BASE_URL=http://localhost:3000/api/v1
      - VITE_WEBSOCKET_URL=ws://localhost:3000
    depends_on:
      - backend

  backend:
    build: ./backend
    ports:
      - "3000:3000"
    volumes:
      - ./backend:/app
      - /app/node_modules
    environment:
      - PORT=3000
      - NODE_ENV=development
      - POSTGRES_HOST=postgres
      - POSTGRES_PORT=5432
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=ai_meeting_assistant
      - MONGO_URI=mongodb://mongo:27017/ai_meeting_assistant
      - REDIS_HOST=redis
      - REDIS_PORT=6379
      - RABBITMQ_HOST=rabbitmq
      - RABBITMQ_PORT=5672
      - RABBITMQ_USER=guest
      - RABBITMQ_PASSWORD=guest
    depends_on:
      - postgres
      - mongo
      - redis
      - rabbitmq

  postgres:
    image: postgres:15-alpine
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=ai_meeting_assistant

  mongo:
    image: mongo:6-jammy
    ports:
      - "27017:27017"
    volumes:
      - mongo_data:/data/db

  redis:
    image: redis:7.2-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  rabbitmq:
    image: rabbitmq:3.12-management-alpine
    ports:
      - "5672:5672"
      - "15672:15672"
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq

volumes:
  postgres_data:
  mongo_data:
  redis_data:
  rabbitmq_data:
```

## 7. 开发工作流

### 7.1 代码风格

- 使用ESLint进行代码检查
- 使用Prettier进行代码格式化
- 遵循Conventional Commits规范进行提交

### 7.2 分支管理

- `main`：主分支，用于生产环境
- `develop`：开发分支，用于集成所有功能
- `feature/xxx`：功能分支，用于开发新功能
- `bugfix/xxx`：bug修复分支，用于修复bug

### 7.3 提交规范

使用Conventional Commits规范，格式如下：
```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

常用type：
- `feat`：新功能
- `fix`：修复bug
- `docs`：文档更新
- `style`：代码风格变更
- `refactor`：代码重构
- `test`：测试相关
- `chore`：构建过程或辅助工具的变动

## 8. 常见问题与解决方案

### 8.1 前端开发常见问题

1. **依赖安装失败**
   - 解决方案：删除 `node_modules` 和 `package-lock.json`，重新安装依赖
   ```bash
   rm -rf node_modules package-lock.json
   npm install
   ```

2. **开发服务器启动失败**
   - 解决方案：检查端口是否被占用，尝试修改端口号
   ```bash
   # 修改vite.config.ts中的端口
   server: {
     port: 5174
   }
   ```

3. **TypeScript类型错误**
   - 解决方案：运行 `npm run typecheck` 检查类型错误，并修复

### 8.2 后端开发常见问题

1. **数据库连接失败**
   - 解决方案：检查数据库是否运行，环境变量配置是否正确
   ```bash
   # 检查PostgreSQL状态
   sudo systemctl status postgresql
   # 检查MongoDB状态
   sudo systemctl status mongod
   ```

2. **端口被占用**
   - 解决方案：修改 `.env` 文件中的 `PORT` 环境变量

3. **API请求返回500错误**
   - 解决方案：查看日志，定位错误原因
   ```bash
   npm run dev > server.log 2>&1
   ```

### 8.3 Docker相关问题

1. **Docker容器启动失败**
   - 解决方案：查看容器日志，定位错误原因
   ```bash
   docker-compose logs <service-name>
   ```

2. **端口冲突**
   - 解决方案：修改 `docker-compose.yml` 中的端口映射

3. **容器内文件不更新**
   - 解决方案：确保挂载了正确的卷，重启容器
   ```bash
   docker-compose restart <service-name>
   ```

## 9. 参考资源

- [Vue 3 官方文档](https://vuejs.org/)
- [Element Plus 文档](https://element-plus.org/)
- [Node.js 官方文档](https://nodejs.org/)
- [NestJS 文档](https://docs.nestjs.com/)
- [PostgreSQL 官方文档](https://www.postgresql.org/docs/)
- [MongoDB 官方文档](https://docs.mongodb.com/)
- [Docker 官方文档](https://docs.docker.com/)
- [Docker Compose 文档](https://docs.docker.com/compose/)

## 10. 附录

### 10.1 环境变量说明

| 变量名 | 用途 | 默认值 |
|--------|------|--------|
| `PORT` | 后端服务端口 | 3000 |
| `NODE_ENV` | 运行环境 | development |
| `POSTGRES_HOST` | PostgreSQL主机 | localhost |
| `POSTGRES_PORT` | PostgreSQL端口 | 5432 |
| `POSTGRES_USER` | PostgreSQL用户名 | postgres |
| `POSTGRES_PASSWORD` | PostgreSQL密码 | password |
| `POSTGRES_DB` | PostgreSQL数据库名 | ai_meeting_assistant |
| `MONGO_URI` | MongoDB连接URI | mongodb://localhost:27017/ai_meeting_assistant |
| `REDIS_HOST` | Redis主机 | localhost |
| `REDIS_PORT` | Redis端口 | 6379 |
| `RABBITMQ_HOST` | RabbitMQ主机 | localhost |
| `RABBITMQ_PORT` | RabbitMQ端口 | 5672 |
| `RABBITMQ_USER` | RabbitMQ用户名 | guest |
| `RABBITMQ_PASSWORD` | RabbitMQ密码 | guest |
| `VITE_API_BASE_URL` | 前端API基础URL | http://localhost:3000/api/v1 |
| `VITE_WEBSOCKET_URL` | WebSocket连接URL | ws://localhost:3000 |

### 10.2 联系方式

- 项目负责人：XXX
- 技术负责人：XXX
- 开发团队：XXX
- 联系方式：XXX
