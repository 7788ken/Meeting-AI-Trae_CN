# AI会议助手技术方案

## 1. 文档概述

### 1.1 文档目的
本方案描述AI会议助手的技术架构、技术栈选型、模块划分和核心配置，为AI编程提供清晰的技术指导。

### 1.2 术语定义
| 术语 | 解释 |
|------|------|
| Vue 3 | 前端JavaScript框架 |
| Node.js | 后端JavaScript运行环境 |
| Express | Node.js的Web框架 |
| PostgreSQL | 关系型数据库 |
| MongoDB | 文档型数据库 |
| PM2 | Node.js的进程管理工具 |
| Nginx | 反向代理服务器 |
| Docker | 容器化平台 |
| JWT | JSON Web Token，用于身份认证 |

## 2. 技术选型

### 2.1 前端技术栈
| 技术 | 版本 | 用途 |
|------|------|------|
| Vue | 3.4.x | 前端框架 |
| Element Plus | 2.5.x | UI组件库 |
| Pinia | 2.1.x | 状态管理 |
| Vue Router | 4.2.x | 路由管理 |
| Axios | 1.6.x | HTTP客户端 |
| Vite | 5.0.x | 构建工具 |
| TypeScript | 5.3.x | 类型检查 |
| ESLint | 8.56.x | 代码检查 |
| Prettier | 3.2.x | 代码格式化 |

### 2.2 后端技术栈
| 技术 | 版本 | 用途 |
|------|------|------|
| Node.js | 18.18.x | 运行环境 |
| NestJS | 10.3.x | Web框架 |
| PM2 | 5.3.x | 进程管理 |
| PostgreSQL | 15.4.x | 关系型数据库 |
| MongoDB | 6.0.x | 文档型数据库 |
| Prisma | 5.7.x | 数据库ORM |
| Redis | 7.2.x | 缓存层 |
| JWT | 9.0.x | 认证授权 |
| Winston | 3.11.x | 日志管理 |
| Swagger | 4.6.x | API文档 |
| RabbitMQ | 3.12.x | 消息队列 |

### 2.3 开发工具
| 工具 | 用途 |
|------|------|
| VS Code | 代码编辑器 |
| Git | 版本控制 |
| Postman | API测试 |
| Docker | 容器化开发 |

### 2.4 第三方服务
| 服务类型 | 服务商 | 用途 | 调用成本（元/千tokens） |
|----------|--------|------|----------------------|
| 语音识别API | 火山引擎（豆包流语音识别模型2.0） | 将语音转换为文字 | - |
| AI大模型API | 千问 | 生成AI分析和回答 | 0.15 |
| AI大模型API | doubao | 生成AI分析和回答 | 0.2 |
| AI大模型API | GLM（智谱AI） | 生成AI分析和回答 | 0.2 |
| AI大模型API | MINIMAX | 生成AI分析和回答 | 0.3 |
| AI大模型API | KIMI | 生成AI分析和回答 | 0.4 |
| AI大模型API | DC | 生成AI分析和回答 | 0.5 |
| 对象存储 | 自建服务器 | 存储录音文件和导出的会议记录 | - |
| CDN | 阿里云CDN、腾讯云CDN | 加速静态资源访问 | - |
| DDoS防护 | 阿里云盾、腾讯云安全 | 防止DDoS攻击 | - |

## 3. 系统架构

### 3.1 整体架构
```
┌─────────────────────────────────────────────────────────────────────────┐
│                          前端应用层                                    │
├─────────────────────────────────────────────────────────────────────────┤
│  Vue 3 + TypeScript + Element Plus + Vite                              │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          API网关层                                     │
├─────────────────────────────────────────────────────────────────────────┤
│  Kong（API网关、负载均衡、认证授权、限流监控）                        │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          微服务层                                      │
├─────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐         │
│  │ 会议微服务      │  │ 语音处理微服务   │  │  AI分析微服务    │         │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐         │
│  │ 用户管理微服务   │  │ 存储服务        │  │ 配置中心        │         │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘         │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          中间件层                                     │
├─────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                     │
│  │ RabbitMQ    │  │ Consul       │  │ Redis        │                     │
│  └─────────────┘  └─────────────┘  └─────────────┘                     │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          数据存储层                                     │
├─────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                     │
│  │ PostgreSQL  │  │ MongoDB     │  │ 对象存储（自建/云）│             │
│  └─────────────┘  └─────────────┘  └─────────────┘                     │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          第三方服务层                                   │
├─────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌───────────────────────────────────────────┐         │
│  │ 语音识别API │  │  AI大模型API（千问、doubao、GLM、MINIMAX、KIMI、DC）│         │
│  └─────────────┘  └───────────────────────────────────────────┘         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.2 模块划分

#### 3.2.1 前端模块
| 模块 | 职责 |
|------|------|
| 会议管理模块 | 会议的创建、查看、编辑、删除 |
| 录音转写模块 | 麦克风录音、语音转写 |
| 发言管理模块 | 发言记录的展示、编辑、搜索 |
| AI分析模块 | AI分析的生成、展示、模型切换 |
| 状态管理模块 | 管理应用的状态 |
| 路由管理模块 | 管理应用的路由 |
| API请求模块 | 封装API请求 |

#### 3.2.2 后端模块
| 模块 | 职责 |
|------|------|
| 会议会话服务模块 | 处理会议会话相关的业务逻辑 |
| 语音处理模块 | 处理语音录音、转写、发言者识别 |
| AI服务模块 | 处理AI分析、回答生成 |
| 数据存储模块 | 处理数据的存储和查询 |
| API路由模块 | 定义API路由 |
| 中间件模块 | 通用中间件 |
| 配置模块 | 配置管理 |
| 模型模块 | 数据库模型定义 |

## 4. 环境配置

### 4.1 环境变量配置
```dotenv
# 服务器配置
PORT=3000
NODE_ENV=development

# 数据库配置
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
POSTGRES_DB=ai_meeting_assistant

MONGO_URI=mongodb://localhost:27017/ai_meeting_assistant

# JWT配置
JWT_SECRET=your_jwt_secret
JWT_EXPIRES_IN=7d

# 第三方服务配置
DOUBAO_SPEECH_API_KEY=your_doubao_speech_api_key
DOUBAO_SPEECH_SECRET_KEY=your_doubao_speech_secret_key
DOUBAO_SPEECH_APP_ID=your_doubao_speech_app_id

AI_MODEL_API_KEY=your_ai_model_api_key
```

### 4.2 Docker配置
```yaml
version: '3.8'
services:
  frontend:
    build: ./frontend
    ports:
      - "5173:5173"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    environment:
      - VITE_API_BASE_URL=http://localhost:3000/api/v1
    depends_on:
      - backend

  backend:
    build: ./backend
    ports:
      - "3000:3000"
    volumes:
      - ./backend:/app
      - /app/node_modules
    environment:
      - PORT=3000
      - POSTGRES_HOST=postgres
      - POSTGRES_PORT=5432
      - MONGO_URI=mongodb://mongo:27017/ai_meeting_assistant
    depends_on:
      - postgres
      - mongo

  postgres:
    image: postgres:15-alpine
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=ai_meeting_assistant

  mongo:
    image: mongo:6-jammy
    ports:
      - "27017:27017"
    volumes:
      - mongo_data:/data/db

volumes:
  postgres_data:
  mongo_data:
```

## 5. 核心功能实现

### 5.1 实时语音转写
- 麦克风录音：实时捕获会议中的发言
- 语音流识别：使用豆包流语音识别模型2.0实时转换语音为文字
- 实时显示：转写结果实时显示
- 发言者识别：自动识别不同的发言者
- 标点自动添加：智能添加标点符号，提高可读性

### 5.2 上下文管理
- 发言记录整理：按时间顺序组织发言记录
- 上下文关联：自动关联当前会议的所有发言内容
- 实时更新：随着会议进行，上下文自动扩展
- 关键信息标记：自动标记会议中的关键信息

### 5.3 AI辅助分析
- 单条发言分析：
  - 核心要点提炼：提取发言的核心思想
  - 简要回答生成：针对发言内容生成简洁回答
  - 深度分析：生成详细的深度分析
- 多发言关联分析：基于多条发言的上下文生成综合分析
- 模型选择：支持从千问、doubao、GLM、MINIMAX、KIMI、DC中选择不同模型
- 分析结果导出：支持导出分析结果

### 5.4 发言记录管理
- 发言列表：按时间顺序显示所有发言记录
- 发言编辑：允许修改转写错误的文字
- 关键词搜索：支持按关键词快速定位发言
- 发言标记：支持手动标记重要发言
- 记录保存：支持保存完整的会议记录

### 5.5 设备适配
- 跨设备支持：适配PC、平板、手机等多种设备
- 麦克风适配：支持外接麦克风和内置麦克风
- 背景噪音抑制：智能抑制背景噪音，提高识别准确率

## 6. 测试策略

### 6.1 测试类型
- **单元测试**：测试单个函数或组件，覆盖率目标≥80%
- **集成测试**：测试模块之间的交互，覆盖率目标≥70%
- **端到端测试**：测试完整的用户流程
- **性能测试**：测试系统在高并发下的性能
- **安全测试**：测试系统的安全性

### 6.2 测试工具
- 前端单元测试：Vitest
- 后端单元测试：Jest
- 端到端测试：Cypress
- 性能测试：Artillery或JMeter
- 安全测试：OWASP ZAP或Burp Suite

## 7. 部署方案

### 7.1 生产环境部署架构
```
┌─────────────────────────────────────────────────────────────────────────┐
│                          负载均衡层                                     │
├─────────────────────────────────────────────────────────────────────────┤
│  Nginx（负载均衡、SSL终止、静态资源缓存）                              │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
            ┌─────────────────────┼─────────────────────┐
            │                     │                     │
            ▼                     ▼                     ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  前端应用实例1   │     │  前端应用实例2   │     │  前端应用实例3   │
└─────────────────┘     └─────────────────┘     └─────────────────┘
            │                     │                     │
            └─────────────────────┼─────────────────────┘
                                  │
            ┌─────────────────────┼─────────────────────┐
            │                     │                     │
            ▼                     ▼                     ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  后端应用实例1   │     │  后端应用实例2   │     │  后端应用实例3   │
└─────────────────┘     └─────────────────┘     └─────────────────┘
            │                     │                     │
            └─────────────────────┼─────────────────────┘
                                  │
            ┌─────────────────────┼─────────────────────┐
            │                     │                     │
            ▼                     ▼                     ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  PostgreSQL主库  │────▶│  PostgreSQL从库1 │     │  PostgreSQL从库2 │
└─────────────────┘     └─────────────────┘     └─────────────────┘
                                  │
            ┌─────────────────────┼─────────────────────┐
            │                     │                     │
            ▼                     ▼                     ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  MongoDB主节点  │────▶│  MongoDB从节点1 │     │  MongoDB从节点2 │
└─────────────────┘     └─────────────────┘     └─────────────────┘
```

### 7.2 Nginx配置
```nginx
server {
    listen 80;
    server_name example.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name example.com;

    ssl_certificate /etc/nginx/ssl/example.com.crt;
    ssl_certificate_key /etc/nginx/ssl/example.com.key;

    # 前端静态资源
    location / {
        root /var/www/frontend;
        index index.html;
        try_files $uri $uri/ /index.html;
        expires 1d;
    }

    # 后端API
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

## 8. 监控与安全

### 8.1 监控方案
- **前端监控**：使用Sentry进行错误监控和性能监控
- **后端监控**：使用Prometheus + Grafana进行性能监控
- **日志管理**：使用Winston进行日志管理，ELK Stack进行日志分析
- **数据库监控**：PostgreSQL使用pg_stat_statements，MongoDB使用MongoDB Atlas监控

### 8.2 安全策略
- **数据安全**：使用SSL/TLS加密传输，数据库加密存储，基于角色的访问控制
- **应用安全**：使用Helmet增强Express应用安全性，实现请求速率限制，输入验证和参数过滤
- **服务器安全**：配置防火墙，定期更新系统和软件，使用SSH密钥登录

## 9. 附录

### 9.1 参考文档
- AI会议助手功能需求说明书
- 系统架构设计文档
- 数据模型设计文档
- API接口规范文档

### 9.2 版本历史
| 版本 | 作者 | 变更内容 |
|------|------|----------|
| V1.0 | AI助手 | 初始版本 |