# AI会议助手模块设计文档

## 1. 文档概述

本文档基于项目资料，对AI会议助手进行细粒度的原子化模块设计，明确每个模块的职责和边界，为开发团队提供清晰的模块划分依据。

## 2. 模块设计原则

- **单一职责原则**：每个模块只负责一个特定的功能
- **原子化设计**：模块拆分到最细粒度，便于维护和扩展
- **高内聚低耦合**：模块内部高度内聚，模块间低耦合
- **接口驱动**：模块间通过明确的接口进行通信
- **可测试性**：每个模块易于独立测试

## 3. 前端模块设计

### 3.1 基础框架模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| vue-core | Vue 3核心框架集成 | Vue 3.4.x |
| type-check | TypeScript类型检查配置 | TypeScript 5.3.x |
| vite-build | Vite构建配置 | Vite 5.0.x |
| eslint-config | ESLint代码检查配置 | ESLint 8.56.x |
| prettier-config | Prettier代码格式化配置 | Prettier 3.2.x |

### 3.2 路由管理模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| router-config | 路由配置管理 | Vue Router 4.2.x |
| route-guards | 路由守卫（认证、权限） | Vue Router 4.2.x |
| route-components | 路由组件注册 | Vue Router 4.2.x |

### 3.3 状态管理模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| pinia-core | Pinia核心集成 | Pinia 2.1.x |
| session-store | 会话状态管理 | Pinia 2.1.x |
| speech-store | 发言记录状态管理 | Pinia 2.1.x |
| ai-store | AI分析状态管理 | Pinia 2.1.x |
| settings-store | 设置状态管理 | Pinia 2.1.x |

### 3.4 会话管理模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| session-create | 会话创建功能 | Vue 3 |
| session-end | 会话结束功能 | Vue 3 |
| session-status | 会话状态显示 | Vue 3 |
| session-list | 会话列表展示 | Vue 3 |
| session-detail | 会话详情展示 | Vue 3 |

### 3.5 录音转写模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| mic-permission | 麦克风权限管理 | Web API |
| audio-capture | 实时音频捕获 | Web API |
| speech-to-text | 语音转写调用 | WebSocket |
| punctuation-addition | 智能标点添加 | JavaScript |
| speaker-recognition | 发言者自动识别 | Web API |

### 3.6 转写展示模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| transcript-display | 转写结果展示 | Vue 3 |
| speaker-color | 发言者色彩区分 | Vue 3 |
| confidence-indicator | 转写置信度显示 | Vue 3 |
| real-time-edit | 实时编辑功能 | Vue 3 |
| auto-scroll | 自动滚动控制 | Vue 3 |

### 3.7 发言管理模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| speech-list | 发言列表展示 | Vue 3 |
| speech-edit | 发言内容编辑 | Vue 3 |
| speech-search | 发言关键词搜索 | Vue 3 |
| speech-mark | 发言标记功能 | Vue 3 |
| speaker-management | 发言者管理 | Vue 3 |

### 3.8 AI分析模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| ai-generate | AI分析生成 | Axios |
| ai-display | AI分析结果展示 | Vue 3 |
| model-switch | AI模型切换 | Vue 3 |
| analysis-type | 分析类型切换（核心要点/简要回答/深度分析） | Vue 3 |
| analysis-export | 分析结果导出 | Vue 3 |

### 3.9 UI组件模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| button | 按钮组件 | Element Plus |
| input | 输入框组件 | Element Plus |
| dropdown | 下拉菜单组件 | Element Plus |
| tabs | 标签页组件 | Element Plus |
| card | 卡片组件 | Element Plus |
| message | 消息提示组件 | Element Plus |
| dialog | 对话框组件 | Element Plus |
| loading | 加载状态组件 | Element Plus |

### 3.10 API请求模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| axios-config | Axios配置 | Axios 1.6.x |
| request-interceptor | 请求拦截器 | Axios 1.6.x |
| response-interceptor | 响应拦截器 | Axios 1.6.x |
| error-handler | 错误处理 | Axios 1.6.x |
| api-service | API服务封装 | Axios 1.6.x |

### 3.11 WebSocket模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| ws-connection | WebSocket连接管理 | WebSocket API |
| ws-message | WebSocket消息处理 | WebSocket API |
| ws-reconnect | 自动重连机制 | JavaScript |

### 3.12 工具函数模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| time-format | 时间格式化 | JavaScript |
| string-util | 字符串处理 | JavaScript |
| file-util | 文件处理 | JavaScript |
| storage-util | 本地存储管理 | Web API |
| uuid-util | UUID生成 | JavaScript |

## 4. 后端模块设计

### 4.1 基础架构模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| nest-core | NestJS核心框架 | NestJS 10.3.x |
| config-manager | 配置管理 | NestJS Config |
| logger | 日志管理 | Winston 3.11.x |
| exception-filter | 全局异常过滤器 | NestJS |
| validation-pipe | 数据验证管道 | NestJS |

### 4.2 会话管理模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| session-controller | 会话控制器 | NestJS |
| session-service | 会话业务逻辑 | NestJS |
| session-repository | 会话数据访问 | Prisma 5.7.x |
| session-dto | 会话数据传输对象 | TypeScript |
| session-validator | 会话数据验证 | Class Validator |

### 4.3 语音处理模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| speech-controller | 语音处理控制器 | NestJS |
| speech-service | 语音处理业务逻辑 | NestJS |
| speech-to-text-service | 语音转写调用 | Axios |
| speaker-recognition-service | 发言者识别 | Machine Learning |
| audio-processing | 音频预处理 | FFmpeg |

### 4.4 AI服务模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| ai-controller | AI控制器 | NestJS |
| ai-service | AI业务逻辑 | NestJS |
| model-manager | AI模型管理 | TypeScript |
| model-client-qianwen | 千问模型客户端 | Axios |
| model-client-doubao | 豆包模型客户端 | Axios |
| model-client-glm | GLM模型客户端 | Axios |
| model-client-minimax | MINIMAX模型客户端 | Axios |
| model-client-kimi | KIMI模型客户端 | Axios |
| model-client-dc | DC模型客户端 | Axios |

### 4.5 发言记录模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| speech-controller | 发言控制器 | NestJS |
| speech-service | 发言业务逻辑 | NestJS |
| speech-repository | 发言数据访问 | MongoDB |
| speech-dto | 发言数据传输对象 | TypeScript |
| speech-search | 发言搜索功能 | MongoDB Atlas Search |

### 4.6 AI分析记录模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| analysis-controller | AI分析控制器 | NestJS |
| analysis-service | AI分析业务逻辑 | NestJS |
| analysis-repository | AI分析数据访问 | MongoDB |
| analysis-dto | AI分析数据传输对象 | TypeScript |

### 4.7 发言者管理模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| speaker-controller | 发言者控制器 | NestJS |
| speaker-service | 发言者业务逻辑 | NestJS |
| speaker-repository | 发言者数据访问 | Prisma 5.7.x |
| speaker-dto | 发言者数据传输对象 | TypeScript |

### 4.8 数据存储模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| postgres-connection | PostgreSQL连接管理 | Prisma 5.7.x |
| mongodb-connection | MongoDB连接管理 | Mongoose |
| redis-connection | Redis连接管理 | Redis 7.2.x |
| prisma-client | Prisma客户端 | Prisma 5.7.x |
| mongoose-client | Mongoose客户端 | Mongoose |

### 4.9 WebSocket模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| ws-gateway | WebSocket网关 | NestJS WebSocket |
| ws-handler | WebSocket消息处理 | NestJS WebSocket |
| ws-adapter | WebSocket适配器 | NestJS WebSocket |

### 4.10 API文档模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| swagger-config | Swagger配置 | Swagger 4.6.x |
| swagger-decorators | Swagger装饰器 | Swagger 4.6.x |

### 4.11 认证授权模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| jwt-strategy | JWT认证策略 | Passport JWT |
| auth-guard | 认证守卫 | NestJS |
| jwt-service | JWT生成与验证 | JWT 9.0.x |

### 4.12 中间件模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| cors-middleware | CORS中间件 | NestJS |
| logger-middleware | 请求日志中间件 | NestJS |
| rate-limit-middleware | 速率限制中间件 | NestJS |

## 5. 数据模型模块

### 5.1 PostgreSQL表模型

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| session-table | 会话表结构 | PostgreSQL 15.4.x |
| speaker-table | 发言者表结构 | PostgreSQL 15.4.x |
| user-table | 用户表结构 | PostgreSQL 15.4.x |

### 5.2 MongoDB集合模型

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| speech-collection | 发言记录集合 | MongoDB 6.0.x |
| ai-analysis-collection | AI分析结果集合 | MongoDB 6.0.x |

### 5.3 数据关系模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| session-speech-relation | 会话与发言关系 | TypeScript |
| speech-analysis-relation | 发言与AI分析关系 | TypeScript |
| session-speaker-relation | 会话与发言者关系 | TypeScript |

## 6. 外部服务模块

### 6.1 语音识别服务模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| doubao-speech-client | 豆包流语音识别模型2.0客户端 | Axios |
| speech-api-config | 语音API配置 | TypeScript |
| speech-error-handler | 语音API错误处理 | TypeScript |

### 6.2 AI大模型服务模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| ai-api-config | AI API配置 | TypeScript |
| ai-error-handler | AI API错误处理 | TypeScript |
| ai-rate-limiter | AI API速率限制 | TypeScript |

## 7. 部署与运维模块

### 7.1 Docker模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| dockerfile-frontend | 前端Dockerfile | Docker |
| dockerfile-backend | 后端Dockerfile | Docker |
| docker-compose | Docker Compose配置 | Docker Compose |

### 7.2 CI/CD模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| github-actions | GitHub Actions配置 | YAML |
| build-script | 构建脚本 | Bash |
| deploy-script | 部署脚本 | Bash |

### 7.3 监控模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| prometheus-config | Prometheus配置 | Prometheus |
| grafana-dashboard | Grafana仪表盘 | Grafana |
| sentry-integration | Sentry集成 | Sentry |

## 8. 测试模块

### 8.1 前端测试模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| unit-test | 单元测试 | Vitest |
| integration-test | 集成测试 | Vitest |
| e2e-test | 端到端测试 | Cypress |
| mock-service | 模拟服务 | MSW |

### 8.2 后端测试模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| unit-test | 单元测试 | Jest |
| integration-test | 集成测试 | Jest |
| e2e-test | 端到端测试 | Supertest |
| test-fixtures | 测试数据 | TypeScript |

## 9. 配置文件模块

| 模块名称 | 模块职责 | 技术栈 |
|----------|----------|--------|
| .env.example | 环境变量示例 | Dotenv |
| vite.config.ts | Vite配置 | TypeScript |
| tsconfig.json | TypeScript配置 | TypeScript |
| eslint.config.js | ESLint配置 | JavaScript |
| prettier.config.js | Prettier配置 | JavaScript |

## 10. 模块关系图

```mermaid
graph TD
    subgraph 前端
        A[基础框架模块] --> B[路由管理模块]
        A --> C[状态管理模块]
        B --> D[会话管理模块]
        B --> E[录音转写模块]
        B --> F[转写展示模块]
        B --> G[发言管理模块]
        B --> H[AI分析模块]
        C --> D
        C --> E
        C --> F
        C --> G
        C --> H
        E --> F
        G --> H
        I[UI组件模块] --> D
        I --> E
        I --> F
        I --> G
        I --> H
        J[API请求模块] --> D
        J --> G
        J --> H
        K[WebSocket模块] --> E
        K --> F
        L[工具函数模块] --> D
        L --> E
        L --> F
        L --> G
        L --> H
    end

    subgraph 后端
        M[基础架构模块] --> N[会话管理模块]
        M --> O[语音处理模块]
        M --> P[AI服务模块]
        M --> Q[发言记录模块]
        M --> R[AI分析记录模块]
        M --> S[发言者管理模块]
        M --> T[WebSocket模块]
        M --> U[API文档模块]
        M --> V[认证授权模块]
        M --> W[中间件模块]
        N --> Q
        N --> S
        O --> Q
        P --> R
        Q --> R
        X[数据存储模块] --> N
        X --> O
        X --> P
        X --> Q
        X --> R
        X --> S
    end

    subgraph 数据模型
        Y[PostgreSQL表模型] --> N
        Y --> S
        Z[MongoDB集合模型] --> Q
        Z --> R
    end

    subgraph 外部服务
        AA[语音识别服务模块] --> O
        AB[AI大模型服务模块] --> P
    end

    subgraph 部署与运维
        AC[Docker模块] --> A
        AC --> M
        AD[CI/CD模块] --> A
        AD --> M
        AE[监控模块] --> M
    end

    subgraph 测试
        AF[前端测试模块] --> A
        AG[后端测试模块] --> M
    end

    subgraph 配置文件
        AH[配置文件模块] --> A
        AH --> M
    end

    J --> N
    J --> O
    J --> P
    J --> Q
    J --> R
    J --> S
    K --> T
    T --> F
    T --> E
end
```

## 11. 模块设计原则验证

| 原则 | 验证结果 | 说明 |
|------|----------|------|
| 单一职责 | ✅ | 每个模块只负责一个特定功能 |
| 原子化设计 | ✅ | 模块拆分到最细粒度，如AI模型按品牌拆分 |
| 高内聚低耦合 | ✅ | 模块内部高度内聚，模块间通过接口通信 |
| 接口驱动 | ✅ | 模块间通过明确的API接口或服务接口通信 |
| 可测试性 | ✅ | 每个模块易于独立测试，配有测试模块 |

## 12. 更新日志

| 更新日期 | 更新内容 | 更新人 |
|----------|----------|--------|
| 2026-01-09 | 初始创建模块设计文档 | AI助手 |
